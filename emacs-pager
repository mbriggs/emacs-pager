#!/usr/bin/env python

import tempfile
import subprocess
import sys

# TODO: When this is run with -t pass the argument to emacsclient, so
# that it's possible to use emacs-pager as the PAGER even outside of
# *shell* buffers!
if __name__ == '__main__':
    try:
        with tempfile.NamedTemporaryFile(suffix='.emacs-pager', mode='w+b') as f:
            bytes = sys.stdin.read()
            f.write(bytes)
            f.flush()
            sys.exit(subprocess.call('emacsclient %s' % f.name, shell=True))
    except KeyboardInterrupt, e:
        print >> sys.stderr, 'Interrupted'
        sys.exit(74)            # EX_IOERR from sysexits.h
    sys.exit(1)                 # Should *not* be reached normally.
